version: "3.1"

rules:
  - rule: Xử lý chào hỏi
    steps:
      - intent: greet
      - action: action_get_user_info
      - action: utter_greet

  - rule: Xử lý tạm biệt
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - rule: Khởi động lại slot
    steps:
      - intent: restart_slot
      - action: action_restart_slot

  - rule: FAQ - Máy nóng
    condition:
      - active_loop: null
    steps:
      - intent: faq_overheating
      - action: utter_faq_overheating

  - rule: FAQ - Lỗi kết nối
    condition:
      - active_loop: null
    steps:
      - intent: faq_connection_issue
      - action: utter_faq_connection_issue

  - rule: Cung cấp thông tin sản phẩm
    steps:
      - intent: ask_product_info
      - action: action_provide_product_info

  - rule: Cung cấp thông tin bảo hành
    steps:
      - intent: ask_warranty
      - action: action_provide_warranty_info

  - rule: Cung cấp thông tin cửa hàng
    steps:
      - intent: ask_store
      - action: action_provide_store_info

  - rule: Cung cấp thông tin (chung chung) về đơn hàng
    steps:
      - intent: ask_order
      - action: action_provide_order_info

  - rule: Gợi ý sản phẩm theo giá
    steps:
      - intent: suggest_product_price
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo RAM
    steps:
      - intent: suggest_product_ram
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo Pin
    steps:
      - intent: suggest_product_battery
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo dung lượng
    steps:
      - intent: suggest_product_storage
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm (kết hợp)
    steps:
      - intent: suggest_product_combine
      - action: action_suggest_product

  - rule: Tra đơn hàng bằng ID
    steps:
      - intent: ask_order_specific
      - action: action_check_order_specific

  - rule: Tra đơn hàng theo trạng thái
    steps:
      - intent: ask_order_filter
      - action: action_check_order_filter

  - rule: Tra đơn hàng theo thời gian
    steps:
      - intent: ask_order_filter
      - action: action_check_order_filter

  - rule: Tra đơn hàng theo thời gian + trạng thái
    steps:
      - intent: ask_order_filter
      - action: action_check_order_filter

  - rule: Tra đơn hàng theo sản phẩm
    steps:
      - intent: ask_order_by_product
      - action: action_check_order_by_product

  - rule: Tra đơn hàng chưa thanh toán
    steps:
      - intent: ask_unpaid_orders
      - action: action_check_unpaid_or_unshipped_orders

  - rule: Tra đơn hàng đang giao
    steps:
      - intent: ask_unshipped_orders
      - action: action_check_unpaid_or_unshipped_orders

  - rule: Xem các đơn hàng gần đây
    steps:
      - intent: ask_recent_orders
      - action: action_list_recent_orders

  - rule: Hiển thị chi tiết phiên bản sản phẩm
    steps:
      - intent: show_variant_details
      - action: action_show_variant_details

  - rule: Người dùng chọn chi nhánh khi đặt hàng
    steps:
      - intent: select_branch_order
      - action: action_confirm_after_branch

  - rule: Người dùng chọn chi nhánh khi thêm giỏ hàng
    steps:
      - intent: select_branch_cart
      - action: action_add_to_cart

  - rule: Hủy đơn hàng
    condition:
      - active_loop: null
    steps:
      - intent: cancel_order
      - action: action_cancel_order

  - rule: Xử lý khi form trả hàng hoàn tất
    condition:
      - active_loop: return_order_form
      - slot_was_set:
          - order_id: true
          - return_reason: true
    steps:
      - action: return_order_form
      - active_loop: null
      - action: action_return_order

  - rule: Hoàn tất form và gọi action_add_to_cart
    condition:
      - active_loop: add_to_cart_form
    steps:
      - action: add_to_cart_form
      - active_loop: null
      - action: action_add_to_cart

  - rule: Xử lý ngoài phạm vi hoặc không hiểu
    steps:
      - intent: out_of_scope
      - action: utter_fallback
