version: "3.1"

rules:
  - rule: Xử lý chào hỏi
    steps:
      - intent: greet
      - action: action_get_user_info

  - rule: Xử lý tạm biệt
    steps:
      - intent: goodbye
      - action: utter_goodbye

  - rule: Khởi động lại slot
    steps:
      - intent: restart_slot
      - action: action_restart_slot

  - rule: FAQ - Hỏi chung
    condition:
      - active_loop: null
    steps:
      - intent: faq
      - action: utter_faq
    
  - rule: Respond to chitchat (Trả lời tán gẫu)
    steps:
      - intent: chitchat
      - action: utter_chitchat

  - rule: Cung cấp thông tin sản phẩm
    steps:
      - intent: ask_product_info
      - action: action_provide_product_info

  - rule: Cung cấp thông tin bảo hành
    steps:
      - intent: ask_warranty
      - action: action_provide_warranty_info

  - rule: Cung cấp thông tin cửa hàng
    steps:
      - intent: ask_store
      - action: action_provide_store_info

  - rule: Gợi ý sản phẩm theo giá
    steps:
      - intent: suggest_product_price
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo RAM
    steps:
      - intent: suggest_product_ram
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo Pin
    steps:
      - intent: suggest_product_battery
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm theo dung lượng
    steps:
      - intent: suggest_product_storage
      - action: action_suggest_product

  - rule: Gợi ý sản phẩm (kết hợp)
    steps:
      - intent: suggest_product_combine
      - action: action_suggest_product

  - rule: Tra đơn hàng (tổng hợp)
    steps:
      - intent: ask_order
      - action: action_check_order

  - rule: Tra đơn hàng chưa hoàn thành
    steps:
      - intent: ask_pending_orders
      - action: action_check_pending_orders

  - rule: Xem các đơn hàng gần đây
    steps:
      - intent: ask_recent_orders
      - action: action_list_recent_orders

  - rule: Hiển thị chi tiết phiên bản sản phẩm
    steps:
      - intent: show_variant_details
      - action: action_show_variant_details

  - rule: Người dùng chọn chi nhánh khi đặt hàng
    steps:
      - intent: select_branch_order
      - action: action_confirm_after_branch

  - rule: Người dùng chọn chi nhánh khi thêm giỏ hàng
    steps:
      - intent: select_branch_cart
      - action: action_add_to_cart

  - rule: Hủy tiến trình đặt hàng
    condition:
      - active_loop: null
    steps:
      - intent: cancel
      - action: action_cancel_ordering_process

  - rule: Hủy đơn hàng
    condition:
      - active_loop: null
    steps:
      - intent: cancel_order
      - action: action_cancel_order

  - rule: Xử lý khi form trả hàng hoàn tất
    condition:
      - active_loop: return_order_form
      - slot_was_set:
          - order_id: true
          - return_reason: true
    steps:
      - action: return_order_form
      - active_loop: null
      - action: action_return_order

  - rule: Hoàn tất form và gọi action_add_to_cart
    condition:
      - active_loop: add_to_cart_form
    steps:
      - action: add_to_cart_form
      - active_loop: null
      - action: action_add_to_cart

  - rule: hỏi danh sách biến thể sản phẩm
    steps:
      - intent: ask_product_variant_infor
      - action: action_show_list_variants
  - rule: hỏi thông tin chi tiết biến thể sản phẩm
    steps:
      - intent: ask_product_detail_variant_infor
      - action: action_provide_product_spec

  - rule: Cập nhật số lượng giỏ hàng (Tăng hoặc Giảm)
    steps:
      - intent: update_cart_quantity
      - action: action_update_cart_quantity

  - rule: Xử lý ngoài phạm vi hoặc không hiểu
    steps:
      - intent: out_of_scope
      - action: utter_fallback
