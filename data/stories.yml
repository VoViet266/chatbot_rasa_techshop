version: "3.1"

stories:
  # 2. HỎI THÔNG TIN SẢN PHẨM
  - story: Hỏi thông tin sản phẩm (nêu rõ tên)
    steps:
      - intent: ask_product_info
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_provide_product_info

  - story: Hỏi giá sản phẩm rồi chỉ xem
    steps:
      - intent: ask_product_price
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_provide_product_price
      - action: utter_ask_if_want_to_order
      - intent: chitchat/just_looking
      - action: utter_chitchat/just_looking
      - slot_was_set:
          - product: null

  - story: Hỏi giá sản phẩm rồi quyết định mua
    steps:
      - intent: ask_product_price
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_provide_product_price
      - action: utter_ask_if_want_to_order
      - intent: order
      - action: order_form
      - active_loop: order_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: action_preview_order
      - intent: confirm_order
      - action: action_submit_order
      - slot_was_set:
          - product: null
          - variant_name: null
          - quantity: null

  - story: Hỏi chính sách bảo hành
    steps:
      - intent: ask_warranty
      - action: action_provide_warranty_info

  - story: Hỏi thông tin cửa hàng
    steps:
      - intent: ask_store
      - action: action_provide_store_info

  # 3. ĐẶT HÀNG
  - story: Quy trình đặt hàng đầy đủ (Full Happy Path)
    steps:
      - intent: ask_product_info
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_provide_product_info
      - intent: order
      - action: order_form
      - active_loop: order_form
      - active_loop: null
      - action: action_preview_order
      - intent: confirm_order
      - action: action_submit_order
      - slot_was_set:
          - product: null
          - variant_name: null
          - quantity: null

  - story: Đặt hàng nhanh
    steps:
      - intent: order
      - action: order_form
      - active_loop: order_form
      - active_loop: null
      - action: action_preview_order
      - intent: confirm_order
      - action: action_submit_order

  - story: Đặt hàng nhanh (nêu thẳng sản phẩm)
    steps:
      - intent: order
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: order_form
      - active_loop: order_form
      - active_loop: null
      - action: action_preview_order
      - intent: confirm_order
      - action: action_submit_order

  - story: Hủy đặt hàng sau khi xem trước đơn
    steps:
      - intent: order
      - action: order_form
      - active_loop: order_form
      - active_loop: null
      - action: action_preview_order
      - intent: cancel_order
      - action: action_cancel_order
      
  # Thêm sản phẩm vào giỏ hàng
  - story: quy trình thêm giỏ hàng
    steps:
      - intent: add_to_cart
      - action: add_to_cart_form
      - active_loop: add_to_cart_form
      - active_loop: null
      - action: action_add_to_cart
      - intent: add_to_cart
      - action: action_add_to_cart

  # 4. TRA CỨU ĐƠN HÀNG
  - story: Tra đơn hàng bằng ID (người dùng nhập sẵn)
    steps:
      - intent: ask_order_specific
        entities:
          - order_id: "6673f8a7e0965e26f63111ed"
      - action: action_check_order_specific
      - slot_was_set:
          - order_id: "6673f8a7e0965e26f63111ed"

  - story: Tra đơn hàng khi chưa nhập ID
    steps:
      - intent: ask_order_general
      - action: utter_ask_order_id
      - intent: ask_order_specific
        entities:
          - order_id: "1234567890abcdef12345678"
      - action: action_check_order_specific
      - slot_was_set:
          - order_id: "1234567890abcdef12345678"

  - story: Tra đơn hàng theo thứ tự (đơn mới nhất)
    steps:
      - intent: ask_order_general
        entities:
          - order_direction: "newest"
          - order_index: "1"
      - slot_was_set:
          - order_direction: "newest"
          - order_index: "1"
      - action: action_check_order_general

  - story: Tra đơn hàng theo trạng thái
    steps:
      - intent: ask_order_filter
        entities:
          - order_status: "đang giao"
      - slot_was_set:
          - order_status: "đang giao"
      - action: action_check_order_filter

  - story: Tra đơn hàng theo thời gian
    steps:
      - intent: ask_order_filter
        entities:
          - time: "hôm qua"
      - slot_was_set:
          - time: "hôm qua"
      - action: action_check_order_filter

  - story: Tra đơn hàng theo thời gian và trạng thái
    steps:
      - intent: ask_order_filter
        entities:
          - time: "tuần trước"
          - order_status: "đã giao"
      - slot_was_set:
          - time: "tuần trước"
          - order_status: "đã giao"
      - action: action_check_order_filter

  # 1️⃣ Tra đơn hàng theo sản phẩm
  - story: Tra đơn hàng theo sản phẩm
    steps:
      - intent: ask_order_by_product
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_check_order_by_product
      - slot_was_set:
          - product: null

  - story: Tra đơn hàng chưa thanh toán
    steps:
      - intent: ask_unpaid_orders
      - action: action_check_unpaid_or_unshipped_orders

  - story: Tra đơn hàng đang giao
    steps:
      - intent: ask_unshipped_orders
      - action: action_check_unpaid_or_unshipped_orders

  - story: Xem các đơn hàng gần đây
    steps:
      - intent: ask_recent_orders
      - action: action_list_recent_orders

  # 5. SO SÁNH & KIỂM TRA HÀNG TỒN
  - story: So sánh sản phẩm qua form
    steps:
      - intent: compare_products
      - action: compare_products_form
      - active_loop: compare_products_form
      - active_loop: null
      - action: action_compare_products

  - story: So sánh trực tiếp hai sản phẩm
    steps:
      - intent: compare_products
        entities:
          - product_1: "iPhone 16"
          - product_2: "Galaxy S24"
      - slot_was_set:
          - product_1: "iPhone 16"
          - product_2: "Galaxy S24"
      - action: action_compare_products

  - story: Kiểm tra hàng tồn (chỉ có tên)
    steps:
      - intent: check_stock
        entities:
          - product: "iPhone 16"
      - slot_was_set:
          - product: "iPhone 16"
      - action: action_check_stock

  - story: Kiểm tra hàng tồn (kèm dung lượng & màu)
    steps:
      - intent: check_stock
        entities:
          - product: "Macbook Air"
          - variant_spec: "256GB"
          - variant_color: "bạc"
      - slot_was_set:
          - product: "Macbook Air"
          - variant_name: "256GB"
          - variant_color: "bạc"
      - action: action_check_stock

  # 6. NGOÀI PHẠM VI / FALLBACK
  - story: Xử lý câu hỏi ngoài phạm vi
    steps:
      - intent: out_of_scope
      - action: utter_fallback
